/*! imagediff.js 1.0.2
  * (c) 2011 Carl Sutherland, Humble Software Development
  * imagediff.js is freely distributable under the MIT license.
  * Thanks to Jacob Thornton for the node/amd integration bits.
  * For details and documentation:
  * https://github.com/HumbleSoftware/js-imagediff
  */
(function(a,b){var c=this;typeof module!="undefined"?module.exports=b():typeof define=="function"&&typeof define.amd=="object"?define(b):c[a]=b(c,a)})("imagediff",function(a,b){function n(a,b){var c=document.createElement("canvas");return a&&(c.width=a),b&&(c.height=b),c}function o(a,b){return i.width=a,i.height=b,j.clearRect(0,0,a,b),j.createImageData(a,b)}function p(a){return u(a,f)}function q(a){return u(a,d)}function r(a){return u(a,e)}function s(a){return a&&typeof a===g&&typeof a.width!==h&&typeof a.height!==h&&typeof a.data!==h?!0:!1}function t(a){return p(a)||q(a)||r(a)||s(a)}function u(a,b){return typeof a=="object"&&Object.prototype.toString.apply(a)===b}function v(a){var b=a.height,c=a.width,d=a.data,e,f,g;i.width=c,i.height=b,e=j.getImageData(0,0,c,b),f=e.data;for(g=a.data.length;g--;)f[g]=d[g];return e}function w(a){if(p(a))return x(a);if(q(a))return y(a);if(r(a))return z(a);if(s(a))return a}function x(a){var b=a.height,c=a.width;return i.width=c,i.height=b,j.clearRect(0,0,c,b),j.drawImage(a,0,0),j.getImageData(0,0,c,b)}function y(a){var b=a.height,c=a.width,d=a.getContext("2d");return d.getImageData(0,0,c,b)}function z(a){var b=a.canvas,c=b.height,d=b.width;return a.getImageData(0,0,d,c)}function A(a){var b=w(a),c=n(b.width,b.height),d=c.getContext("2d");return d.putImageData(b,0,0),c}function B(a,b){return a.width===b.width}function C(a,b){return a.height===b.height}function D(a,b){return C(a,b)&&B(a,b)}function E(a,b,c){var d=a.data,e=b.data,f=d.length,c=c||0,g;if(!D(a,b))return!1;for(g=f;g--;)if(d[g]!==e[g]&&Math.abs(d[g]-e[g])>c)return!1;return!0}function F(a,b){return(D(a,b)?G:H)(a,b)}function G(a,b){var c=a.height,d=a.width,e=o(d,c),f=a.data,g=b.data,h=e.data,i=h.length,j,k,l,m,n,p;for(l=0;l<i;l+=4)h[l]=Math.abs(f[l]-g[l]),h[l+1]=Math.abs(f[l+1]-g[l+1]),h[l+2]=Math.abs(f[l+2]-g[l+2]),h[l+3]=Math.abs(255-f[l+3]-g[l+3]);return e}function H(a,b){function r(a){i=Math.floor((c-a.height)/2),j=Math.floor((d-a.width)/2)}var c=Math.max(a.height,b.height),d=Math.max(a.width,b.width),e=o(d,c),f=a.data,g=b.data,h=e.data,i,j,k,l,m,n,p,q;for(m=h.length-1;m>0;m-=4)h[m]=255;r(a);for(k=a.height;k--;)for(l=a.width;l--;)m=4*((k+i)*d+(l+j)),n=4*(k*a.width+l),h[m+0]=f[n+0],h[m+1]=f[n+1],h[m+2]=f[n+2];r(b);for(k=b.height;k--;)for(l=b.width;l--;)m=4*((k+i)*d+(l+j)),n=4*(k*b.width+l),h[m+0]=Math.abs(h[m+0]-g[n+0]),h[m+1]=Math.abs(h[m+1]-g[n+1]),h[m+2]=Math.abs(h[m+2]-g[n+2]);return e}function I(){var a;for(a=0;a<arguments.length;a++)if(!t(arguments[a]))throw{name:"ImageTypeError",message:"Submitted object was not an image."}}function J(a,b){return a=document.createElement(a),a&&b&&(a.innerHTML=b),a}var c="[object Array]",d="[object HTMLCanvasElement]",e="[object CanvasRenderingContext2D]",f="[object HTMLImageElement]",g="object",h="undefined",i=n(),j=i.getContext("2d"),k=a[b],l,m;return m={toBeImageData:function(){return l.isImageData(this.actual)},toImageDiffEqual:function(a,b){return this.message=function(){var b=J("div"),c=J("div","<div>Actual:</div>"),d=J("div","<div>Expected:</div>"),e=J("div","<div>Diff:</div>"),f=l.diff(this.actual,a),g=n(),h;return g.height=f.height,g.width=f.width,h=g.getContext("2d"),h.putImageData(f,0,0),c.appendChild(A(this.actual)),d.appendChild(A(a)),e.appendChild(g),b.appendChild(c),b.appendChild(d),b.appendChild(e),[b,"Expected not to be equal."]},l.equal(this.actual,a,b)}},l={createCanvas:n,createImageData:o,isImage:p,isCanvas:q,isContext:r,isImageData:s,isImageType:t,toImageData:function(a){return I(a),s(a)?v(a):w(a)},equal:function(a,b,c){return I(a,b),a=w(a),b=w(b),E(a,b,c)},diff:function(a,b){return I(a,b),a=w(a),b=w(b),F(a,b)},jasmine:m,noConflict:function(){return a[b]=k,l}},l})